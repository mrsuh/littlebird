<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Birthday Quest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
    >

    <style>
        body {
            background: linear-gradient(135deg, #fff7e6, #e3f2fd);
            min-height: 100vh;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .app-wrapper {
            min-height: 100vh;
        }

        .game-card {
            border-radius: 1rem;
            border: none;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
            background: #ffffffcc;
            backdrop-filter: blur(6px);
        }

        .question-img {
            border-radius: 0.75rem;
            max-height: 280px;
            object-fit: cover;
        }

        .badge-step {
            background: #ffb74d;
            color: #4e342e;
            font-weight: 600;
        }

        .btn-main {
            background: #42a5f5;
            border-color: #42a5f5;
            font-weight: 600;
        }

        .btn-main:hover {
            background: #1e88e5;
            border-color: #1e88e5;
        }

        .fun-title {
            font-weight: 700;
            color: #ff7043;
        }

        .fun-emoji {
            font-size: 1.8rem;
        }

        .success-emoji {
            font-size: 3rem;
        }
    </style>
</head>
<body>
<div class="container app-wrapper d-flex align-items-center justify-content-center py-4">
    <div id="app" class="w-100" style="max-width: 480px;"></div>
</div>
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"
></script>

<script>
    const questions = [
        {
            text: "–ú–∞–ª–µ–Ω—å–∫–æ–µ —Å–æ–ª–Ω—Ü–µ –Ω–∞ –Ω–æ–∂–∫–µ",
            answer: "1993",
            image: "img/lamp.png"
        },
        {
            text: "–õ–µ—Ç–∞–µ—Ç –±–µ–∑ –∫—Ä—ã–ª—å–µ–≤ –∏ –æ—á–µ–Ω—å –±–æ–∏—Ç—Å—è –∏–≥–æ–ª–æ–∫",
            answer: "9681",
            image: "img/balloon.png"
        },
        {
            text: "–•—Ä–∞–Ω–∏—Ç —Å–∞–º—ã–µ –≤–∫—É—Å–Ω—ã–µ –∏–¥–µ–∏ –ë–æ–±–∞",
            answer: "4843",
            image: "img/recipe.png"
        },
        {
            text: "–ö—Ç–æ —Å—è–¥–µ—Ç –Ω–∞ –Ω–µ–≥–æ - —Ç–æ—Ç –ø–æ—á—É–≤—Å—Ç–≤—É–µ—Ç, –≥–¥–µ —Å–ø—Ä—è—Ç–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥.",
            answer: "7025",
            image: "img/chair.png"
        },
        {
            text: "–ö–æ–¥ –ø—Ä—è—á–µ—Ç—Å—è –≤ —Ö–≤–æ—Å—Ç–µ –Ω–æ–º–µ—Ä–∞ –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–∞ (4 —Ü–∏—Ñ—Ä—ã)",
            answer: "4788",
            image: "img/phone.png"
        },
        {
            text: "–°–ª–∞–¥–∫–∏–π, –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π, –∫—Ä–∞—Å–∏–≤—ã–π",
            answer: "1512",
            image: "img/cake.png"
        },
        {
            text: "–ö—Ç–æ —Å—Ç—É—á–∏—Ç—å—Å—è –≤ –¥–≤–µ—Ä—å –∫–æ –º–Ω–µ —Å —Ç–æ–ª—Å—Ç–æ–π —Å—É–º–∫–æ–π –Ω–∞ —Ä–µ–º–Ω–µ?",
            answer: "3011",
            image: "img/mail.png"
        },
    ];

    const STORAGE_KEY = "encounter_current_question_v1";

    function loadCurrentQuestionIndex() {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return 0;
        const n = parseInt(raw, 10);
        if (Number.isNaN(n) || n < 0 || n > questions.length) return 0;
        return n;
    }

    function saveCurrentQuestionIndex(index) {
        localStorage.setItem(STORAGE_KEY, String(index));
    }

    let currentQuestionIndex = loadCurrentQuestionIndex();
    const app = document.getElementById("app");

    function render() {
        app.innerHTML = "";

        // ===== –ö–∞—Ä—Ç–æ—á–∫–∞-–ø–æ–¥—Å–∫–∞–∑–∫–∞ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" (—Å–≤–µ—Ä—Ö—É) =====
        const infoCard = document.createElement("div");
        infoCard.className = "card game-card p-3 p-sm-3 mb-3";

        const infoTitle = document.createElement("h2");
        infoTitle.className = "h6 mb-2 text-primary fw-semibold d-flex align-items-center gap-2";
        infoTitle.innerHTML = '<span>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</span> <span>‚ú®</span>';
        infoCard.appendChild(infoTitle);

        const infoText = document.createElement("p");
        infoText.className = "mb-1 small";
        infoText.textContent =
            "–ü–æ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º –Ω–∞—Ö–æ–¥–∏ —Å–ø—Ä—è—Ç–∞–Ω–Ω—ã–µ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ –∏ –ø–æ–¥—ä–µ–∑–¥–µ –∫–æ–¥—ã –∏ –≤–≤–æ–¥–∏ –∏—Ö –≤ –ø–æ–ª–µ –Ω–∏–∂–µ. " +
            "–ï—Å–ª–∏ –∫–æ–¥ –≤–µ—Ä–Ω—ã–π ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å.";
        infoCard.appendChild(infoText);

        const infoNote = document.createElement("p");
        infoNote.className = "mb-0 small text-muted";
        infoNote.textContent = "–ï—Å–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—à—å —Å—Ç—Ä–∞–Ω–∏—Ü—É, –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è üôÇ";
        infoCard.appendChild(infoNote);

        app.appendChild(infoCard);
        // ===== –ö–æ–Ω–µ—Ü –±–ª–æ–∫–∞ "–ö–∞–∫ –∏–≥—Ä–∞—Ç—å" =====

        // –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–π–¥–µ–Ω—ã
        if (currentQuestionIndex >= questions.length) {
            const card = document.createElement("div");
            card.className = "card game-card p-4 text-center";

            const emoji = document.createElement("div");
            emoji.className = "success-emoji mb-3";
            emoji.textContent = "üéâ";
            card.appendChild(emoji);

            const title = document.createElement("h2");
            title.className = "fun-title mb-3";
            title.textContent = "–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!";
            card.appendChild(title);

            const msg = document.createElement("p");
            msg.className = "mb-3";
            msg.textContent = "–¢–≤–æ–π –ø–æ–¥–∞—Ä–æ—á–µ–∫ –∂–¥–µ—Ç —Ç–µ–±—è –¥–æ–º–∞!";
            card.appendChild(msg);

            const resetBtn = document.createElement("button");
            resetBtn.className = "btn btn-outline-secondary btn-sm";
            resetBtn.textContent = "–ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞";
            resetBtn.addEventListener("click", () => {
                currentQuestionIndex = 0;
                saveCurrentQuestionIndex(currentQuestionIndex);
                render();
            });
            card.appendChild(resetBtn);

            app.appendChild(card);
            return;
        }

        const question = questions[currentQuestionIndex];

        const card = document.createElement("div");
        card.className = "card game-card p-3 p-sm-4";

        // –®–∞–ø–∫–∞
        const headerRow = document.createElement("div");
        headerRow.className = "d-flex justify-content-between align-items-center mb-2";

        const title = document.createElement("h1");
        title.className = "h5 mb-0 fun-title d-flex align-items-center gap-2";
        title.innerHTML = '<span class="fun-emoji">üéà</span><span>Birthday Quest</span>';
        headerRow.appendChild(title);

        const badge = document.createElement("span");
        badge.className = "badge badge-step rounded-pill px-3 py-2";
        badge.textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} / ${questions.length}`;
        headerRow.appendChild(badge);

        card.appendChild(headerRow);

        // –ö–∞—Ä—Ç–∏–Ω–∫–∞
        const imgWrapper = document.createElement("div");
        imgWrapper.className = "mb-3";
        const img = document.createElement("img");
        img.src = question.image;
        img.alt = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1}`;
        img.className = "img-fluid question-img w-100";
        imgWrapper.appendChild(img);
        card.appendChild(imgWrapper);

        // –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
        const qText = document.createElement("p");
        qText.className = "mb-3";
        qText.textContent = question.text;
        card.appendChild(qText);

        // –ü–æ–ª–µ –≤–≤–æ–¥–∞ + –∫–Ω–æ–ø–∫–∞
        const formRow = document.createElement("div");
        formRow.className = "row g-2 align-items-stretch mb-2";

        const colInput = document.createElement("div");
        colInput.className = "col-8 col-sm-9";
        const input = document.createElement("input");
        input.type = "text";
        input.className = "form-control";
        input.placeholder = "–í–≤–µ–¥–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–¥";
        input.autocomplete = "off";
        colInput.appendChild(input);
        formRow.appendChild(colInput);

        const colBtn = document.createElement("div");
        colBtn.className = "col-4 col-sm-3 d-grid";
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "btn btn-main";
        btn.textContent = "OK";
        colBtn.appendChild(btn);
        formRow.appendChild(colBtn);

        card.appendChild(formRow);

        // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        const error = document.createElement("div");
        error.className = "text-danger small mt-1";
        error.style.display = "none";
        card.appendChild(error);

        // –ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ —Ä–µ–≥–∏—Å—Ç—Ä–µ
        const hint = document.createElement("div");
        hint.className = "text-muted small mt-1";
        hint.textContent = "–†–µ–≥–∏—Å—Ç—Ä –±—É–∫–≤ –Ω–µ –≤–∞–∂–µ–Ω: –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –∏ –º–∞–ª–µ–Ω—å–∫–∏–º–∏, –∏ –±–æ–ª—å—à–∏–º–∏.";
        card.appendChild(hint);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏
        function checkAnswer() {
            const userValue = input.value.trim();
            if (!userValue) {
                error.textContent = "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –∫–æ–¥ üôÇ";
                error.style.display = "block";
                return;
            }

            const normalizedUser = userValue.toLowerCase();
            const normalizedCorrect = String(question.answer).trim().toLowerCase();

            if (normalizedUser === normalizedCorrect) {
                error.style.display = "none";
                currentQuestionIndex += 1;
                saveCurrentQuestionIndex(currentQuestionIndex);
                render();
            } else {
                error.textContent = "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ üí°";
                error.style.display = "block";
            }
        }

        btn.addEventListener("click", checkAnswer);
        input.addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
                checkAnswer();
            }
        });

        app.appendChild(card);

        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å
        setTimeout(() => input.focus(), 0);
    }

    render();
</script>
</body>
</html>
